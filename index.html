<!DOCTYPE html>
<html lang="ja">
<head>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff9500">

<!-- iOSç”¨ -->
<link rel="apple-touch-icon" href="icon-192.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="äºˆå®šç™»éŒ²">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>éŸ³å£°äºˆå®šã‚¢ãƒ©ãƒ¼ãƒ </title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="app">
    <header>ğŸ¤ éŸ³å£°äºˆå®šã‚¢ãƒ©ãƒ¼ãƒ </header>

    <main>
      <div class="hint">
        ä¾‹ï¼šã€Œæ˜æ—¥ã®15æ™‚ã«æ­¯åŒ»è€…ã€ã€Œ18æ™‚ãƒã‚¤ãƒˆã€
      </div>

      <button id="startBtn">éŸ³å£°å…¥åŠ›é–‹å§‹</button>

      <ul id="scheduleList"></ul>
    </main>
  </div>

  <script>
    const startBtn = document.getElementById("startBtn");
    const list = document.getElementById("scheduleList");

    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      alert("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°èªè­˜ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ï¼ˆChromeæ¨å¥¨ï¼‰");
    }

    const recognition = new SpeechRecognition();
    recognition.lang = "ja-JP";

    Notification.requestPermission();

    startBtn.onclick = () => {
      recognition.start();
      startBtn.classList.add("listening"); // éŒ²éŸ³ä¸­ã«é’ãå…‰ã‚‹
    };

    recognition.onresult = (event) => {
      const text = event.results[0][0].transcript;
      addSchedule(text);
    };

    recognition.onend = () => {
      startBtn.classList.remove("listening");
    };

    recognition.onerror = () => {
      startBtn.classList.remove("listening");
    };

    function addSchedule(text) {
      const li = document.createElement("li");
      li.textContent = text;
      list.appendChild(li);
      save();
    }

    function save() {
      const items = [];
      document.querySelectorAll("li").forEach(li =>
        items.push(li.textContent)
      );
      localStorage.setItem("schedules", JSON.stringify(items));
    }

    function load() {
      const data = JSON.parse(
        localStorage.getItem("schedules") || "[]"
      );
      data.forEach(addSchedule);
    }

    load();
  </script>
</body>
</html>
